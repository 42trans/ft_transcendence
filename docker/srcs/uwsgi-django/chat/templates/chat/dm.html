<!-- chat/templates/chat/dm.html -->
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>DM Room</title>

    <!-- メッセージのスタイル（仮仕様） -->
    <style>
        /* DM表示領域 */
        #dm-log {
            width: 600px; /* メッセージログの幅を入力フィールドと同じにする */
            max-height: 400px; /* メッセージログの最大高さを設定 */
            overflow-y: auto; /* 縦方向にスクロールバーを表示 */
            padding: 10px; /* 内側に余白を設定 */
            box-sizing: border-box; /* paddingを含む全体のwidthとheightが600pxと400pxになるように設定 */
        }

        /* DM送信フォーム */
        #message-input {
            width: 600px; /* 幅を600pxに設定 */
        }

        /* メッセージ共通 */
        #dm-log li {
            margin-bottom: 1.3em; /* メッセージ間の間隔を1.5倍に設定 */
            padding: 5px; /* 内側の余白を設定 */
            display: block; /* メッセージを縦に並べる */
            clear: both; /* 他の要素との重なりを防ぐ */
        }

        /* 受信者側のメッセージ */
        #dm-log li.dm-to {
            text-align: left; /* dmToのメッセージを左詰め */
            float: left; /* 左側に配置 */
            background-color: #808080; /* 背景色 */
            color: white; /* 文字色 */
        }

        /* 送信者側のメッセージ */
        #dm-log li.dm-from {
            text-align: right; /* 自分のメッセージを右詰め */
            float: right; /* 右側に配置 */
            background-color: #b0c4de; /* 背景色 */
            color: black; /* 文字色 */
        }
    </style>

</head>
<body>
<h1>DM with [{{ nickname }}]</h1>

<!-- DMより取得したlogを表示 -->
<ul id="dm-log" style="list-style: none;">
    {% for message in messages %}
    <li class="{{ message.sender.nickname|slugify }}">{{ message.sender.nickname }}: {{ message.message|safe }}</li><br>
    {% endfor %}
</ul>

<input id="message-input" type="text">
<input id="message-submit" type="button" value="Send">

<hr>

<p><a href="{% url 'chat:dm_list' %}">dm_list</a></p>

{{ nickname|json_script:"nickname" }}

<script src="{% static 'chat/js/dm.js' %}"></script>


<!-- DOM更新後、dm-logのスクロール位置を最下部に調整 -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const dmLog = document.getElementById('dm-log');
        dmLog.scrollTop = dmLog.scrollHeight;
    });
</script>

</body>
</html>
